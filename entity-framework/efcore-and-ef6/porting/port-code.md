---
title: Перенос приложений из EF6 в EF Core — перенос модели на основе кода
author: rowanmiller
ms.date: 10/27/2016
ms.assetid: 2dce1a50-7d84-4856-abf6-2763dd9be99d
uid: efcore-and-ef6/porting/port-code
ms.openlocfilehash: 2484b681d71ae8711b1b3a59bc274a0b2e403294
ms.sourcegitcommit: dadee5905ada9ecdbae28363a682950383ce3e10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2018
ms.locfileid: "42997053"
---
# <a name="porting-an-ef6-code-based-model-to-ef-core"></a>Перенос модель на основе кода EF6 в EF Core

Если вы прочитали все предупреждения, и вы готовы к порту, Вот несколько рекомендаций, которые помогут вам приступить к работе.

## <a name="install-ef-core-nuget-packages"></a>Установить пакеты EF Core NuGet

Чтобы использовать EF Core, установите пакет NuGet для поставщика базы данных, которую вы хотите использовать. Например, при разработке для SQL Server, требуется установить `Microsoft.EntityFrameworkCore.SqlServer`. См. в разделе [поставщики баз данных](../../core/providers/index.md) подробные сведения.

Если вы планируете использовать migrations, то также следует установить `Microsoft.EntityFrameworkCore.Tools` пакета.

Это можно оставить EF6 установленный пакет NuGet (EntityFramework), как EF Core и EF6 можно использовать side-by-side в одном приложении. Тем не менее если вы не собираетесь использовать EF6 в любой области приложения, то при удалении пакета поможет выдают ошибки компиляции на фрагменты кода, требуют внимания.

## <a name="swap-namespaces"></a>Переключить пространств имен

Большинство интерфейсов API, используемых в EF6 находятся в `System.Data.Entity` пространства имен (и связанные с ней подпространства имен). Первое изменение кода, поменяйте местами для `Microsoft.EntityFrameworkCore` пространства имен. Вы бы, обычно начинается с файла кода производного контекста и затем разработать оттуда адресации ошибки компиляции по мере их появления.

## <a name="context-configuration-connection-etc"></a>Конфигурацию контекста (соединение д.)

Как описано в разделе [обеспечить EF Core будет действий по обеспечению приложения](ensure-requirements.md), EF Core имеет менее magic вокруг обнаружение для подключения к базе данных. Необходимо переопределить `OnConfiguring` метод в производном контексте и используйте поставщик конкретный API базы данных для настройки подключения к базе данных.

Большинство приложений EF6 хранить строки подключения в приложениях `App/Web.config` файл. В EF Core прочтением этой строки подключения с помощью `ConfigurationManager` API. Может потребоваться добавить ссылку на `System.Configuration` framework сборки, чтобы иметь возможность использовать этот API.

``` csharp
public class BloggingContext : DbContext
{
    public DbSet<Blog> Blogs { get; set; }
    public DbSet<Post> Posts { get; set; }

    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
      optionsBuilder.UseSqlServer(ConfigurationManager.ConnectionStrings["BloggingDatabase"].ConnectionString);
    }
}
```

## <a name="update-your-code"></a>Обновление кода

На этом этапе это вопрос адресации ошибки компиляции и проверки кода, чтобы увидеть, если изменения в работе повлияет на вас.

## <a name="existing-migrations"></a>Существующие миграции

Действительно не представляется возможным способ переноса имеющихся миграций EF6 в EF Core.

Если это возможно лучше всего предполагают, что всех предыдущих операций миграции из EF6 были применены к базе данных, а затем start, миграция схемы из этой точки, с использованием EF Core. Чтобы сделать это, используйте `Add-Migration` команду, чтобы добавить миграцию, когда модель будет перенесена в EF Core. Затем, вам нужно удалить весь код из `Up` и `Down` методы шаблонный миграции. Последующей миграции сравниваются в модель при был сформированные для первоначальной миграции.

## <a name="test-the-port"></a>Протестировать порт

Компилирует приложение, не означает, что он успешно перенесена в EF Core. Необходимо будет проверить все области приложения, чтобы убедиться, что ни одно из изменений поведение негативно повлиять на приложения.
