---
title: Разрешение зависимостей - EF6
author: divega
ms.date: 2016-10-23
ms.assetid: 32d19ac6-9186-4ae1-8655-64ee49da55d0
ms.openlocfilehash: c6c56c3048e17a5c888ffe564e7606abf8b0c4ed
ms.sourcegitcommit: 0d36e8ff0892b7f034b765b15e041f375f88579a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2018
ms.locfileid: "44251249"
---
# <a name="dependency-resolution"></a>Разрешение зависимостей
> [!NOTE]
> **Только в EF6 и более поздних версиях**. Функции, API и другие возможности, описанные на этой странице, появились в Entity Framework 6. При использовании более ранней версии могут быть неприменимы некоторые или все сведения.  

Начиная с EF6, Entity Framework содержит механизм общего назначения для получения реализаций служб, которые необходимы. То есть при EF используется экземпляр некоторые интерфейсы или базовые классы вам будет предложено конкретную реализацию интерфейса или базового класса для использования. Это достигается путем использования интерфейса IDbDependencyResolver:  

``` csharp
public interface IDbDependencyResolver
{
    object GetService(Type type, object key);
}
```  

Метод GetService обычно вызывается EF и обрабатывается реализацию IDbDependencyResolver, предоставленное платформой EF или приложением. При вызове аргумент типа является типом интерфейса или базового класса запрашиваемой службы, а объект ключа равно null или объект, предоставляющий контекстную информацию о запрошенную службу.  

Если не указано иное, любой объект, возвращаемый должен быть поточно ориентированной, так как он может использоваться как единственный экземпляр. Во многих случаях объекты, возвращаемые в этом случае является фабрикой самой фабрики должен быть поточно ориентированной, но не нужно быть потокобезопасными, поскольку у фабрики для каждого использования запрашивается новый экземпляр объекта, возвращаемого из фабрики.

Эта статья содержит подробные сведения о том, как реализовать IDbDependencyResolver, но вместо выступает в качестве ссылки для типов служб (то есть, интерфейсов и базовых типах классов), для которых EF вызывает GetService и семантика объекта ключа для каждого из них вызовы.

## <a name="systemdataentityidatabaseinitializertcontext"></a>System.Data.Entity.IDatabaseInitializer < TContext\>  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: инициализатор базы данных для заданного контекста типа  

**Ключ**: не использовать, будет иметь значение null  

## <a name="funcsystemdataentitymigrationssqlmigrationsqlgenerator"></a>Func < System.Data.Entity.Migrations.Sql.MigrationSqlGenerator\>  

**Представленные версии**: EF6.0.0

**Объект, возвращаемый**: фабрику для создания генератора SQL, который может использоваться для миграции и другие действия, вызывающие базы данных, создаваемых, таких как создание базы данных с инициализаторами базы данных.  

**Ключ**: строка, содержащая неизменяемое имя поставщика ADO.NET, указав тип базы данных, для которого будет создаваться SQL. Например генератор SQL Server SQL возвращается для ключа «System.Data.SqlClient»».  

>[!NOTE]
> См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="systemdataentitycorecommondbproviderservices"></a>System.Data.Entity.Core.Common.DbProviderServices  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: поставщик EF для использования данного неизменяемое имя поставщика  

**Ключ**: строка, содержащая неизменяемое имя поставщика ADO.NET, указав тип базы данных, для которого требуется поставщик. Например поставщик SQL Server возвращается для ключа «System.Data.SqlClient»».  

>[!NOTE]
> См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="systemdataentityinfrastructureidbconnectionfactory"></a>System.Data.Entity.Infrastructure.IDbConnectionFactory  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: фабрику соединений, который будет использоваться при EF создает подключение к базе данных по соглашению. То есть при без подключения или строка подключения передается EF, а не строку подключения можно найти в файле app.config или web.config, эта служба затем используется для создания подключения, по соглашению. Изменение Фабрика соединений можно разрешить EF использовать другой тип базы данных (например, SQL Server Compact Edition) по умолчанию.  

**Ключ**: не использовать, будет иметь значение null  

>[!NOTE]
> См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="systemdataentityinfrastructureimanifesttokenservice"></a>System.Data.Entity.Infrastructure.IManifestTokenService  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: служба, можно создать маркер манифеста поставщика из соединения. Эта служба обычно используется двумя способами. Во-первых он может использоваться для предотвращения Code First, соединения с базой данных при построении модели. Во-вторых его можно использовать для принудительного Code First для создания модели для версии конкретной базы данных — например, чтобы принудительно модели для SQL Server 2005, даже если иногда используется SQL Server 2008.  

**Время жизни объекта**: одноэлементный--тот же объект может быть используется несколько раз и одновременно в разных потоков  

**Ключ**: не использовать, будет иметь значение null  

## <a name="systemdataentityinfrastructureidbproviderfactoryservice"></a>System.Data.Entity.Infrastructure.IDbProviderFactoryService  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: служба, можно получить фабрику поставщика из данного соединения. В .NET 4.5 поставщик является общедоступным из соединения. В .NET 4 Реализация по умолчанию эта служба использует часть эвристических правил, чтобы найти соответствующий поставщик. Если они не затем новую реализацию этой службы можно зарегистрировать для обеспечения соответствующего разрешения.  

**Ключ**: не использовать, будет иметь значение null  

## <a name="funcdbcontext-systemdataentityinfrastructureidbmodelcachekey"></a>Func < DbContext, System.Data.Entity.Infrastructure.IDbModelCacheKey\>  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: фабрику, которая создаст ключ кэша модели в данном контексте. По умолчанию EF кэширует одной модели каждого типа DbContext поставщика. Чтобы добавить другие сведения, такие как имя схемы, ключ кэша можно использовать другую реализацию этой службы.  

**Ключ**: не использовать, будет иметь значение null  

## <a name="systemdataentityspatialdbspatialservices"></a>System.Data.Entity.Spatial.DbSpatialServices  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: EF пространственных поставщика, который добавляет в базовый поставщик EF для geography и geometry пространственных типов.  

**Ключ**: DbSptialServices запрашивается двумя способами. Во-первых, поставщика пространственной службы запрашиваются с помощью объекта DbProviderInfo (который содержит инвариант имя и маркер манифеста) как ключ. Во-вторых DbSpatialServices могут запрашиваться без ключа. Это используется для разрешения «глобальные пространственных поставщик» используемый при создании автономного DbGeography или DbGeometry типов.  

>[!NOTE]
> См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="funcsystemdataentityinfrastructureidbexecutionstrategy"></a>Func < System.Data.Entity.Infrastructure.IDbExecutionStrategy\>  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: фабрику для создания службы, которая позволяет поставщику для реализации повторных попыток или другого поведения, при выполнении запросов и команд в базе данных. Если реализации не указаны, затем EF будет просто выполните команды и распространить все исключения. Для SQL Server эта служба используется для предоставления политику повтора, что особенно полезно при запуске для серверов базы данных на основе облака, таких как SQL Azure.  

**Ключ**: ExecutionStrategyKey объект, содержащий неизменяемое имя поставщика и, при необходимости, имя сервера, для которого будет использоваться стратегии выполнения.  

>[!NOTE]
> См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="funcdbconnection-string-systemdataentitymigrationshistoryhistorycontext"></a>Func < DbConnection, строка, System.Data.Entity.Migrations.History.HistoryContext\>  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: фабрику, которая позволяет поставщику настроить сопоставление HistoryContext для `__MigrationHistory` таблицу, используемую миграции EF. HistoryContext является первый DbContext кода и могут быть настроены в обычном fluent API для изменения действия, такие как имя таблицы и спецификации сопоставления столбцов.  

**Ключ**: не использовать, будет иметь значение null  

>[!NOTE]
> См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="systemdatacommondbproviderfactory"></a>System.Data.Common.DbProviderFactory  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: поставщик ADO.NET для использования данного неизменяемое имя поставщика.  

**Ключ**: строка, содержащая неизменяемое имя поставщика ADO.NET  

>[!NOTE]
> Эта служба не изменяется обычно непосредственно, так как в реализации по умолчанию используется обычный Регистрация поставщика ADO.NET. См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="systemdataentityinfrastructureiproviderinvariantname"></a>System.Data.Entity.Infrastructure.IProviderInvariantName  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: это служба, которая используется для определения неизменяемое имя поставщика для данного типа DbProviderFactory. Реализация по умолчанию эта служба использует Регистрация поставщика ADO.NET. Это означает, что если поставщик ADO.NET не зарегистрирован обычным способом, так как объект DbProviderFactory разрешается путем EF, затем он также будет необходимо для устранения этой службы.  

**Ключ**: The DbProviderFactory экземпляра, для которого необходим является инвариантным именем.  

>[!NOTE]
> См. Дополнительные сведения о службах, связанные с поставщиком, в EF6 [модель поставщика EF6](~/ef6/fundamentals/providers/provider-model.md) раздел.  

## <a name="systemdataentitycoremappingviewgenerationiviewassemblycache"></a>System.Data.Entity.Core.Mapping.ViewGeneration.IViewAssemblyCache  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: кэш сборок, содержащих заранее сформированные представления. Замена обычно используется позволяет узнать, какие сборки содержит заранее сформированные представления без выполнения любой обнаружения EF.  

**Ключ**: не использовать, будет иметь значение null  

## <a name="systemdataentityinfrastructurepluralizationipluralizationservice"></a>System.Data.Entity.Infrastructure.Pluralization.IPluralizationService

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: служба, используемая EF pluralize и множественном числе имена. По умолчанию используется в службе преобразования во множественную форму на английском языке.  

**Ключ**: не использовать, будет иметь значение null  

## <a name="systemdataentityinfrastructureinterceptionidbinterceptor"></a>System.Data.Entity.Infrastructure.Interception.IDbInterceptor  

**Представленные версии**: EF6.0.0

**Объекты, возвращаемые**: любой перехватчики, которые должны быть зарегистрированы при запуске приложения. Обратите внимание, что эти объекты запрошены с помощью вызова GetServices и все перехватчики, возвращаемый любой Сопоставитель зависимостей будет зарегистрирована.

**Ключ**: не использовать, будет иметь значение null.  

## <a name="funcsystemdataentitydbcontext-actionstring-systemdataentityinfrastructureinterceptiondatabaselogformatter"></a>Func < System.Data.Entity.DbContext, действие < строка\>, System.Data.Entity.Infrastructure.Interception.DatabaseLogFormatter\>  

**Представленные версии**: EF6.0.0  

**Объект, возвращаемый**: фабрику, которая будет использоваться для создания модуля форматирования журнала базы данных, который будет использовать, когда контекст. Свойство Database.Log устанавливается в заданном контексте.  

**Ключ**: не использовать, будет иметь значение null.  

## <a name="funcsystemdataentitydbcontext"></a>Func < System.Data.Entity.DbContext\>  

**Представленные версии**: EF6.1.0  

**Объект, возвращаемый**: фабрику, которая будет использоваться для создания экземпляров контекста для миграций, если контекст не имеет доступный конструктор без параметров.  

**Ключ**: объект типа для типа производном DbContext, для которого требуется фабрику.  

## <a name="funcsystemdataentitycoremetadataedmimetadataannotationserializer"></a>Func < System.Data.Entity.Core.Metadata.Edm.IMetadataAnnotationSerializer\>  

**Представленные версии**: EF6.1.0  

**Объект, возвращаемый**: фабрику, которая будет использоваться для создания сериализаторы для сериализации со строгой типизацией пользовательских заметок, таким образом, сериализации и desterilized в XML для использования в Code First Migrations.  

**Ключ**: имя, для которого создается заметка сериализации или десериализации.  

## <a name="funcsystemdataentityinfrastructuretransactionhandler"></a>Func < System.Data.Entity.Infrastructure.TransactionHandler\>  

**Представленные версии**: EF6.1.0  

**Объект, возвращаемый**: фабрику, которая будет использоваться для создания обработчиков для транзакций, таким образом, чтобы специальная обработка может применяться для ситуаций, таких как обработка сбоев.  

**Ключ**: ExecutionStrategyKey объект, содержащий неизменяемое имя поставщика и, при необходимости, имя сервера, для которого будет использоваться обработчик транзакции.  
