---
title: С помощью migrate.exe - EF6
author: divega
ms.date: 2016-10-23
ms.prod: entity-framework
ms.author: divega
ms.manager: avickers
ms.technology: entity-framework-6
ms.topic: article
ms.assetid: 989ea862-e936-4c85-926a-8cfbef5df5b8
caps.latest.revision: 3
ms.openlocfilehash: 3a9bc47d2c18abe6ca70b92a8758b4d95010a464
ms.sourcegitcommit: f05e7b62584cf228f17390bb086a61d505712e1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/08/2018
ms.locfileid: "39121870"
---
# <a name="using-migrateexe"></a>С помощью migrate.exe
Code First Migrations может использоваться для обновления базы данных в visual studio, но также можно выполнить с помощью migrate.exe средство командной строки. Эта страница будет дать краткий обзор по использованию migrate.exe для выполнения операций базы данных миграции.

> [!NOTE]
> В этой статье предполагается, что вы знаете, как использовать Code First Migrations в основных сценариях. Если этого не сделать, то нужно будет прочесть [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) перед продолжением.

## <a name="copy-migrateexe"></a>Скопируйте migrate.exe

При установке платформы Entity Framework с помощью NuGet migrate.exe будет в папке tools загруженного пакета. В &lt;папку проекта&gt;\\пакетов\\EntityFramework.&lt; версия&gt;\\средства

При наличии migrate.exe необходимо скопировать его в расположение сборки, содержащей миграции.

Если приложение предназначено для .NET 4, а не 4.5, затем необходимо будет скопировать **Redirect.config** в место, а также и переименуйте его **migrate.exe.config**. Это так, что migrate.exe получит правильные перенаправления привязок чтобы иметь возможность найти сборку платформы Entity Framework.

| .NET 4.5                                   | .NET 4.0                                   |
|:-------------------------------------------|:-------------------------------------------|
| ![Net45Files](~/ef6/media/net45files.png)  | ![Net40Files](~/ef6/media/net40files.png)  |

> [!NOTE]
> migrate.exe не поддерживает x64 сборок.

## <a name="using-migrateexe"></a>С помощью Migrate.exe

После перемещения migrate.exe к папке должен быть использует ее для выполнения миграции в базе данных. Программа призвана сделать всего лишь выполнении миграций. Не может создать миграций или создать скрипт SQL.

### <a name="see-options"></a>См. в разделе параметров

``` console
Migrate.exe /?
```

Оно будет отображаться на страницу справки, связанный с этой программой, обратите внимание, что необходимо будет иметь EntityFramework.dll в том же расположении, migrate.exe выполняются в порядке, чтобы это работало.

### <a name="migrate-to-the-latest-migration"></a>Миграция на последнюю миграции

``` console
Migrate.exe MyMvcApplication.dll /startupConfigurationFile=”..\\web.config”
```

При под управлением migrate.exe только обязательный параметр — это сборки, которая находится на сборку, содержащую миграций, которые вы пытаетесь запустить, но он использует все соглашения на основе параметров, если не указать файл конфигурации.

### <a name="migrate-to-a-specific-migration"></a>Перенос в конкретных миграции

``` console
Migrate.exe MyApp.exe /startupConfigurationFile=”MyApp.exe.config” /targetMigration=”AddTitle”
```

Если вы хотите запустить миграции до конкретных миграции, можно указать имя миграции. Будет запущен всех предыдущих операций перемещения при необходимости до начало миграции указано.

### <a name="specify-working-directory"></a>Укажите рабочий каталог

``` console
Migrate.exe MyApp.exe /startupConfigurationFile=”MyApp.exe.config” /startupDirectory=”c:\\MyApp”
```

Если вы сборка имеет зависимости или считывает файлы относительно рабочего каталога вам потребуется задать startupDirectory.

### <a name="specify-migration-configuration-to-use"></a>Укажите конфигурацию для переноса для использования

``` console
Migrate.exe MyAssembly CustomConfig /startupConfigurationFile=”..\\web.config”
```

Если у вас есть несколько классов конфигурации миграции, классы, наследующие от DbMigrationConfiguration, затем необходимо указать, который будет использоваться при данном выполнении. Это указано, предоставляя необязательный второй параметр без параметра как выше.

### <a name="provide-connection-string"></a>Укажите строку подключения

``` console
Migrate.exe BlogDemo.dll /connectionString=”Data Source=localhost;Initial Catalog=BlogDemo;Integrated Security=SSPI” /connectionProviderName=”System.Data.SqlClient”
```

Если вы хотите указать строку подключения в командной строке, то необходимо также указать имя поставщика. Имя поставщика не указано, вызовет исключение.

## <a name="common-problems"></a>Распространенные проблемы

| Сообщение об ошибке                                                                                                                                                                                                                                                                                                                      | Решение                                                                                                                                                                                                                                                                                             |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Необработанное исключение: System.IO.FileLoadException: не удалось загрузить файл или сборку "EntityFramework, Version = 5.0.0.0, язык и региональные параметры = neutral, PublicKeyToken = b77a5c561934e089" или одну из ее зависимостей. Определение манифеста расположены сборки не соответствует ссылки на сборку. (Исключение из HRESULT: 0x80131040)         | Как правило, это означает, что при запуске приложения .NET 4 без файла Redirect.config. Необходимо скопировать в то же расположение, что migrate.exe Redirect.config и переименуйте его в migrate.exe.config.                                                                                       |
| Необработанное исключение: System.IO.FileLoadException: не удалось загрузить файл или сборку "EntityFramework, Version = 4.4.0.0, язык и региональные параметры = neutral, PublicKeyToken = b77a5c561934e089" или одну из ее зависимостей. Определение манифеста расположены сборки не соответствует ссылки на сборку. (Исключение из HRESULT: 0x80131040)          | Это исключение означает, что вы используете .NET 4.5, приложение с Redirect.config скопированные в расположение migrate.exe. Если приложение является .NET 4.5 файл конфигурации с помощью перенаправления внутри не нужно. Удалите файл migrate.exe.config.                                    |
| Ошибка: Не удалось обновить базу данных для согласования текущей модели, так как имеются ожидающие изменения и отключить автоматический перенос. Включение автоматического переноса или запись изменений ожидающие модели миграции на основе кода. DbMigrationsConfiguration.AutomaticMigrationsEnabled, чтобы задайте значение true, чтобы включить автоматическую миграцию. | Эта ошибка возникает, если выполняется миграция, при миграции, чтобы справиться с изменениями, внесенными в модель еще не создана, а базы данных совпадает с моделью. Добавление свойства в класс модели, запустив migrate.exe без создания миграции для обновления базы данных является примером. |
| Ошибка: Тип не разрешается для члена "System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version = 5.0.0.0, язык и региональные параметры = neutral, PublicKeyToken = b77a5c561934e089".                                                                                                                                       | Эта ошибка может возникать, указав каталог при запуске. Это должно быть расположение migrate.exe                                                                                                                                                                                      |
| Необработанное исключение: System.NullReferenceException: ссылка на объект не указывает на экземпляр объекта. <br/>   в System.Data.Entity.Migrations.Console.Program.Main (String [] args)                                                                                                                                             | Может быть причиной, не указывая обязательный параметр для сценария, который используется. Например, указывающий строку подключения без указания имени поставщика.                                                                                                                        |
| Ошибка: более одного типа миграции конфигурации найден в сборке «ClassLibrary1». Укажите имя любой из них.                                                                                                                                                                                                  | Как говорится в ошибку, имеется более одного класса конфигурации в заданной сборке. Чтобы указать, какие использовать, необходимо использовать параметр /configurationType.                                                                                                                                           |
| Ошибка: Не удалось загрузить файл или сборку "&lt;assemblyName&gt;" или одну из ее зависимостей. Данную сборку имя или базы кода был недопустимым. (Исключение из HRESULT: 0x80131047)                                                                                                                                                    | Это может быть вызвано неправильно Указание имени сборки или отсутствия                                                                                                                                                                                                                          |
| Ошибка: Не удалось загрузить файл или сборку "&lt;assemblyName&gt;" или одну из ее зависимостей. Была сделана попытка загрузить программу, имеющую неверный формат.                                                                                                                                                                          | Это происходит, если вы пытаетесь запустить migrate.exe от x x64 приложения. EF 5.0 и более ранних версий будет работать только на x86.                                                                                                                                                                                |
