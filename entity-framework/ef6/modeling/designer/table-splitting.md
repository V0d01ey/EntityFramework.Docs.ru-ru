---
title: Разделение конструктора таблицы - EF6
author: divega
ms.date: 2016-10-23
ms.prod: entity-framework
ms.author: divega
ms.manager: avickers
ms.technology: entity-framework-6
ms.topic: article
ms.assetid: 452f17c3-9f26-4de4-9894-8bc036e23b0f
caps.latest.revision: 3
ms.openlocfilehash: 6ecf9a77f7c6a743e3902de65bb75349c6ef799f
ms.sourcegitcommit: f05e7b62584cf228f17390bb086a61d505712e1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/08/2018
ms.locfileid: "39121886"
---
# <a name="designer-table-splitting"></a>Разбиение конструктора таблиц
В этом пошаговом руководстве показано, как сопоставить несколько типов сущностей с одной таблицей путем изменения модели с Entity Framework Designer (конструктор EF).

Одна из причин, которые можно использовать разбиение таблиц задерживает загрузки некоторых свойств при использовании отложенной загрузки для загрузки объектов. Свойства, которые могут содержать очень большой объем данных в отдельную сущность и загружать только его при необходимости можно разделить.

На следующем рисунке показана основные окна, которые используются при работе с конструктором EF.

![EFDesigner](~/ef6/media/efdesigner.png)

## <a name="prerequisites"></a>Предварительные требования

Для выполнения данного пошагового руководства требуется:

- Последнюю версию Visual Studio.
- [Образца базы данных School](~/ef6/resources/school-database.md).

## <a name="set-up-the-project"></a>Настройка проекта

В этом пошаговом руководстве используется Visual Studio 2012.

-   Откройте Visual Studio 2012.
-   В меню **Файл** выберите пункт **Создать**, а затем команду **Проект**.
-   В левой области выберите Visual C\#, а затем выберите шаблон консольного приложения.
-   Введите **TableSplittingSample** как имя проекта и нажмите кнопку **ОК**.

## <a name="create-a-model-based-on-the-school-database"></a>Создать модель, основанную на базе данных School

-   Щелкните правой кнопкой мыши имя проекта в обозревателе решений, выберите пункт **добавить**, а затем нажмите кнопку **новый элемент**.
-   Выберите **данных** меню слева, а затем выберите **ADO.NET Entity Data Model** в области шаблонов.
-   Введите **TableSplittingModel.edmx** имя файла, а затем нажмите кнопку **добавить**.
-   В диалоговом окне Выбор содержимого модели выберите **создать из базы данных**, а затем нажмите кнопку **Далее.**
-   Щелкните новое подключение. В диалоговом окне Свойства соединения, введите имя сервера (например, **(localdb)\\mssqllocaldb**) выберите метод проверки подлинности, тип **School** для имени базы данных, а затем Нажмите кнопку **ОК**.
    В диалоговом окне Выбор подключения к базе данных обновляется параметр подключения базы данных.
-   В диалоговом окне Выбор объектов базы данных можно раскрыть **таблиц** узел и проверьте **Person** таблицы. Это добавит к указанной таблице **School** модели.
-   Нажмите кнопку **Готово**.

Конструктор сущностей, который предоставляет область конструктора для изменения модели, отображается. Все объекты, которые выбраны в **Choose Your Database Objects** диалоговое окно добавляются в модель.

## <a name="map-two-entities-to-a-single-table"></a>Сопоставить две сущности с одной таблицей

В этом разделе вы разделите **Person** сущность на две сущности и сопоставьте их с одной таблицей.

> [!NOTE]
> **Person** сущность не содержит все свойства, которые могут содержать большой объем данных; он используется только в качестве примера.

-   Щелкните правой кнопкой мыши пустой участок области конструктора, выберите пункт **Add New**и нажмите кнопку **сущности**.
    **Новую сущность** откроется диалоговое окно.
-   Тип **HireInfo** для **имя сущности** и **PersonID** для **свойство Key** имя.
-   Нажмите кнопку **ОК**.
-   Новый тип сущности будет создан и отобразится в области конструктора.
-   Выберите **HireDate** свойство **Person** типа сущности и нажмите клавишу **Ctrl + X** ключи.
-   Выберите **HireInfo** сущности и нажмите клавишу **Ctrl + V** ключи.
-   Создание ассоциации между **Person** и **HireInfo**. Чтобы сделать это, щелкните правой кнопкой мыши пустой участок области конструктора, выберите пункт **Add New**и нажмите кнопку **ассоциации**.
-   **Добавить сопоставление** откроется диалоговое окно. **PersonHireInfo** присвоено имя по умолчанию.
-   Укажите кратность **1(One)** на обеих сторонах связи.
-   Нажмите клавишу **ОК**.

Для следующего шага требуется **сведения о сопоставлении** окна. Если это окно не отображается, щелкните правой кнопкой мыши область конструктора и выберите **сведения о сопоставлении**.

-   Выберите **HireInfo** типа сущности и нажмите кнопку **&lt;добавить таблицу или представление&gt;** в **сведения о сопоставлении** окна.
-   Выберите **Person** из **&lt;добавить таблицу или представление&gt;** поле с раскрывающимся списком. Список содержит таблицы или представления, который может быть сопоставлен выбранной сущности.
    Необходимо сопоставить соответствующие свойства по умолчанию.

    ![Сопоставление](~/ef6/media/mapping.png)

-   Выберите **PersonHireInfo** ассоциации в рабочей области конструирования.
-   Щелкните правой кнопкой мыши связь на область конструктора и выберите **свойства**.
-   В **свойства** выберите **ссылочные ограничения** свойство и нажмите кнопку с многоточием.
-   Выберите **Person** из **участника** стрелку раскрывающегося списка.
-   Нажмите клавишу **ОК**.

 

## <a name="use-the-model"></a>Использование модели

-   Вставьте следующий код в методе Main.

``` csharp
    using (var context = new SchoolEntities())
    {
        Person person = new Person()
        {
            FirstName = "Kimberly",
            LastName = "Morgan",
            Discriminator = "Instructor",
        };

        person.HireInfo = new HireInfo()
        {
            HireDate = DateTime.Now
        };

        // Add the new person to the context.
        context.People.Add(person);

        // Insert a row into the Person table.  
        context.SaveChanges();

        // Execute a query against the Person table.
        // The query returns columns that map to the Person entity.
        var existingPerson = context.People.FirstOrDefault();

        // Execute a query against the Person table.
        // The query returns columns that map to the Instructor entity.
        var hireInfo = existingPerson.HireInfo;

        Console.WriteLine("{0} was hired on {1}",
            existingPerson.LastName, hireInfo.HireDate);
    }
```
-   Скомпилируйте и запустите приложение.

Следующие инструкции T-SQL были выполнены с **School** базы данных в результате запуска этого приложения. 

-   Следующие **вставить** был выполнен в результате выполнения контекста. SaveChanges() и объединяет данные из **Person** и **HireInfo** сущностей

    ![Insert](~/ef6/media/insert.png)

-   Следующие **ВЫБЕРИТЕ** был выполнен в результате выполнения контекста. People.FirstOrDefault() и выбирает только столбцы сопоставляются **Person**

    ![Select1](~/ef6/media/select1.png)

-   Следующие **ВЫБЕРИТЕ** была выполнена из-за доступа к existingPerson.Instructor свойство навигации и выбирает только нужные столбцы, которые сопоставляются с **HireInfo**

    ![Select2](~/ef6/media/select2.png)
