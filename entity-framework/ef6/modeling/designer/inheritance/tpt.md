---
title: Наследование TPT конструктора — EF6
author: divega
ms.date: 2016-10-23
ms.prod: entity-framework
ms.author: divega
ms.manager: avickers
ms.technology: entity-framework-6
ms.topic: article
ms.assetid: efc78c31-b4ea-4ea3-a0cd-c69eb507020e
caps.latest.revision: 3
ms.openlocfilehash: c3ccb44f931b830a96a553d5af1e722a9ca4bbf0
ms.sourcegitcommit: f05e7b62584cf228f17390bb086a61d505712e1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/08/2018
ms.locfileid: "39122377"
---
# <a name="designer-tpt-inheritance"></a>Наследование TPT конструктора
Это пошаговое руководство показывает, как реализовать наследование таблица на тип (TPT) в вашей модели, с помощью Entity Framework Designer (конструктор EF). В наследовании типа «одна таблица на тип» используется отдельная таблица в базе данных для сопровождения данных, относящихся к ненаследуемым свойствам и ключевым свойствам для каждого типа в иерархии наследования.

В этом пошаговом руководстве мы сопоставим **курс** (базовый тип), **OnlineCourse** (наследует от курса), и **OnsiteCourse** (является производным от **курс**) сущности для таблиц с одинаковыми именами. Мы создадим модель из базы данных и затем изменить модель для реализации наследования TPT.

Можно также начать работу с первой модели и затем создать базу данных из модели. Конструктор EF по умолчанию использует стратегию TPT и поэтому все наследования в модели будут сопоставлены с несколькими таблицами.

## <a name="other-inheritance-options"></a>Другие параметры наследования

Одна таблица на иерархию (TPH) – еще один тип наследования, в которых одна база данных таблица используется для сопровождения данных всех типов сущностей в иерархии наследования.  Сведения о сопоставлении таблица на иерархию наследования с использованием конструктора сущностей см. в разделе [EF конструктор МОДЕЛИ наследования](~/ef6/modeling/designer/inheritance/tph.md). 

Обратите внимание, что таблица на конкретный тип наследования (TPC) и смешанных наследование моделей поддерживаются средой выполнения Entity Framework, но не поддерживаются в конструкторе EF. Если вы хотите использовать TPC или смешанных наследования, можно двумя способами: использовать Code First, или вручную изменить EDMX-файла. Если вы предпочтете работать с файлом EDMX, окно сведений о сопоставлении будет помещен в «безопасный режим», и вы не сможете использовать конструктор для изменения сопоставлений.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения данного пошагового руководства требуется:

- Последнюю версию Visual Studio.
- [Образца базы данных School](~/ef6/resources/school-database.md).

## <a name="set-up-the-project"></a>Настройка проекта

-   Откройте Visual Studio 2012.
-   Выберите **файл -&gt; Новинка —&gt; проекта**
-   В левой области щелкните **Visual C\#**, а затем выберите **консоли** шаблона.
-   Введите **TPTDBFirstSample** как имя.
-   Нажмите кнопку **ОК**.

## <a name="create-a-model"></a>Создание модели

-   Щелкните правой кнопкой мыши проект в обозревателе решений и выберите **Add -&gt; новый элемент**.
-   Выберите **данных** меню слева, а затем выберите **ADO.NET Entity Data Model** в области шаблонов.
-   Введите **TPTModel.edmx** имя файла, а затем нажмите кнопку **добавить**.
-   В диалоговом окне Выбор содержимого модели, выберите ** Создать из базы данных ** и нажмите кнопку **Далее**.
-   Нажмите кнопку **новое подключение**.
    В диалоговом окне Свойства соединения, введите имя сервера (например, **(localdb)\\mssqllocaldb**) выберите метод проверки подлинности, тип **School** для имени базы данных, а затем Нажмите кнопку **ОК**.
    В диалоговом окне Выбор подключения к базе данных обновляется параметр подключения базы данных.
-   В диалоговом окне Выбор объектов базы данных в узле таблицы выберите **отдел**, **курс, OnlineCourse и OnsiteCourse** таблиц.
-   Нажмите кнопку **Готово**.

Конструктор сущностей, который предоставляет область конструктора для изменения модели, отображается. Все объекты, которые выбраны в диалоговом окне Выбор объектов базы данных добавляются в модель.

## <a name="implement-table-per-type-inheritance"></a>Реализация наследования таблица на тип

-   В области конструктора щелкните правой кнопкой мыши **OnlineCourse** типа сущности и выберите **свойства**.
-   В **свойства** окна, задайте для свойства Type базы **курс**.
-   Щелкните правой кнопкой мыши **OnsiteCourse** типа сущности и выберите **свойства**.
-   В **свойства** окна, задайте для свойства Type базы **курс**.
-   Щелкните правой кнопкой мыши ассоциацию (линию) между **OnlineCourse** и **курс** типов сущностей.
    Выберите **удалить из модели**.
-   Щелкните правой кнопкой мыши связь между **OnsiteCourse** и **курс** типов сущностей.
    Выберите **удалить из модели**.

Теперь удалим **CourseID** свойства из **OnlineCourse** и **OnsiteCourse** так, как эти классы наследуют **CourseID** из **курс** базовый тип.

-   Щелкните правой кнопкой мыши **CourseID** свойство **OnlineCourse** тип сущности, а затем выберите **удалить из модели**.
-   Щелкните правой кнопкой мыши **CourseID** свойство **OnsiteCourse** тип сущности, а затем выберите **удалить из модели**
-   Теперь наследование типа «одна таблица на тип» реализовано.

![TPT](~/ef6/media/tpt.png)

## <a name="use-the-model"></a>Использование модели

Откройте **Program.cs** файл, в котором **Main** определен метод. Вставьте следующий код в **Main** функции. Код выполняет три запроса. Первый запрос возвращает все **курсы** связанные с указанное подразделение. Второй запрос использует **OfType** метод для возврата **OnlineCourses** связанные с указанное подразделение. Возвращает третий запрос **OnsiteCourses**.

``` csharp
    using (var context = new SchoolEntities())
    {
        foreach (var department in context.Departments)
        {
            Console.WriteLine("The {0} department has the following courses:",
                               department.Name);

            Console.WriteLine("   All courses");
            foreach (var course in department.Courses )
            {
                Console.WriteLine("     {0}", course.Title);
            }

            foreach (var course in department.Courses.
                OfType<OnlineCourse>())
            {
                Console.WriteLine("   Online - {0}", course.Title);
            }

            foreach (var course in department.Courses.
                OfType<OnsiteCourse>())
            {
                Console.WriteLine("   Onsite - {0}", course.Title);
            }
        }
    }
```
